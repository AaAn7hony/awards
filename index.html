<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AWARDS 2025 - AUEsp</title>
    <link rel="stylesheet" href="css/index.css">
</head>
<body>
    <section id="uno">
        <img src="img/logo.png" alt="Logo Awards 2025">
        <p>¡El AWARDS 2025 ya está aquí! Nomina a tus favoritos.</p>
    </section>

    <section id="dos">
        <button id="loginBtn">¡NOMINA AHORA!</button>
    </section>

    <footer>
        <div class="slide">
            <span>• Artista del año • Dibujo del año • Mejor jugador • Mejor clip • Gifter del año • Staff favorito • "Entretenimiento" favorito • Mejor evento • Juego favorito • MVP • Usuario favorito</span>
            <span>• Artista del año • Dibujo del año • Mejor jugador • Mejor clip • Gifter del año • Staff favorito • "Entretenimiento" favorito • Mejor evento • Juego favorito • MVP • Usuario favorito</span>
        </div>   
    </footer>

    <div id="glow"></div>

<script>
  const glow = document.getElementById('glow');
  const size = 50;

  document.addEventListener('mousemove', (event) => {
    const x = event.clientX;
    const y = event.clientY;

    glow.style.background = `
      radial-gradient(
        circle ${size}px at ${x}px ${y}px,
        rgba(255, 255, 0, 0.1), /* Color blanco muy transparente para el brillo */
        rgba(0, 0, 0, 0)          /* Transparente total */
      )
    `;
  });
</script>

    <script>
        // Configuración de Discord OAuth (reemplaza con tus valores)
        const CLIENT_ID = '1205103896796725278'; // Obtén esto de https://discord.com/developers/applications
        const REDIRECT_URI = 'https://aaan7hony.github.io/auesp-awards/nominaciones.html'; // URL donde se redirige después del login, debe coincidir con la app de Discord
        const SCOPE = 'identify'; // Solo necesitamos identificar al usuario

        const loginBtn = document.getElementById('loginBtn');
        const welcome = document.getElementById('welcome');
        const login = document.getElementById('login');

        let currentCategory = 0;
        let userId = null;

        // Función para validar si es un link de Discord
        function isDiscordLink(url) {
            return url.startsWith('https://discord.com/') || url.startsWith('https://discordapp.com/');
        }

        // Verificar si ya hay un token en la URL (después del redirect)
        const urlParams = new URLSearchParams(window.location.search);
        const code = urlParams.get('code');
        if (code) {
            // Intercambiar code por access token
            fetch('https://discord.com/api/oauth2/token', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: new URLSearchParams({
                    client_id: CLIENT_ID,
                    client_secret: 'TU_CLIENT_SECRET', // Mantén esto secreto, no lo pongas en el frontend
                    grant_type: 'authorization_code',
                    code: code,
                    redirect_uri: REDIRECT_URI,
                }),
            })
            .then(response => response.json())
            .then(data => {
                if (data.access_token) {
                    // Obtener info del usuario
                    return fetch('https://discord.com/api/users/@me', {
                        headers: {
                            Authorization: `Bearer ${data.access_token}`,
                        },
                    });
                } else {
                    throw new Error('Error en autenticación');
                }
            })
            .then(response => response.json())
            .then(user => {
                userId = user.id;
                userNameSpan.textContent = user.username;
                login.style.display = 'none';
                welcome.style.display = 'block';
                // Verificar si ya envió
                if (localStorage.getItem(`submitted_${userId}`)) {
                    alert('Ya has enviado tus nominaciones.');
                    return;
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Error en el login. Intenta de nuevo.');
            });
        }

        loginBtn.addEventListener('click', () => {
            // Redirigir a Discord OAuth
            window.location.href = `https://discord.com/api/oauth2/authorize?client_id=${CLIENT_ID}&redirect_uri=${encodeURIComponent(REDIRECT_URI)}&response_type=code&scope=${SCOPE}`;
        });
</script>
    
</body>
</html>

